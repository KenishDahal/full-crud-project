{"ast":null,"code":"import _objectSpread from\"/Users/kenishdahal/react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/kenishdahal/react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';export default function useFetch(url){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},method=_ref.method,headers=_ref.headers,body=_ref.body;var _useState=useState(),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),errorStatus=_useState4[0],setErrorStatus=_useState4[1];var navigate=useNavigate();var location=useLocation();function request(){fetch(url,{method:method,headers:headers,body:body}).then(function(response){if(response.status===401){navigate('/login',{state:{previousUrl:location.pathname}});}if(!response.ok){throw response.status;}return response.json();}).then(function(data){setData(data);}).catch(function(e){setErrorStatus(e);});}function appendData(newData){fetch(url,{method:'POST',headers:headers,body:JSON.stringify(newData)}).then(function(response){if(response.status===401){navigate('/login',{state:{previousUrl:location.pathname}});}if(!response.ok){throw response.status;}return response.json();}).then(function(d){var submitted=Object.values(d)[0];var newState=_objectSpread({},data);Object.values(newState)[0].push(submitted);setData(newState);//new object, it's seen as a state change\n}).catch(function(e){console.log(e);setErrorStatus(e);});}return{request:request,appendData:appendData,data:data,errorStatus:errorStatus};}","map":{"version":3,"names":["useState","useEffect","useNavigate","useLocation","useFetch","url","method","headers","body","data","setData","errorStatus","setErrorStatus","navigate","location","request","fetch","then","response","status","state","previousUrl","pathname","ok","json","catch","e","appendData","newData","JSON","stringify","d","submitted","Object","values","newState","push","console","log"],"sources":["/Users/kenishdahal/react/src/hooks/UseFetch.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\n\nexport default function useFetch(url, { method, headers, body } = {}) {\n    const [data, setData] = useState();\n    const [errorStatus, setErrorStatus] = useState();\n\n    const navigate = useNavigate();\n    const location = useLocation();\n    function request() {\n        fetch(url, {\n            method: method,\n            headers: headers,\n            body: body,\n        })\n            .then((response) => {\n                if (response.status === 401) {\n                    navigate('/login', {\n                        state: {\n                            previousUrl: location.pathname,\n                        },\n                    });\n                }\n                if (!response.ok) {\n                    throw response.status;\n                }\n                return response.json();\n            })\n            .then((data) => {\n                setData(data);\n            })\n            .catch((e) => {\n                setErrorStatus(e);\n            });\n    }\n\n    function appendData(newData) {\n        fetch(url, {\n            method: 'POST',\n            headers: headers,\n            body: JSON.stringify(newData),\n        })\n            .then((response) => {\n                if (response.status === 401) {\n                    navigate('/login', {\n                        state: {\n                            previousUrl: location.pathname,\n                        },\n                    });\n                }\n\n                if (!response.ok) {\n                    throw response.status;\n                }\n\n                return response.json();\n            })\n            .then((d) => {\n                const submitted = Object.values(d)[0];\n\n                const newState = { ...data };\n                Object.values(newState)[0].push(submitted);\n\n                setData(newState); //new object, it's seen as a state change\n            })\n            .catch((e) => {\n                console.log(e);\n                setErrorStatus(e);\n            });\n    }\n\n    return { request, appendData, data, errorStatus };\n}\n"],"mappings":"2NAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,kBAAzC,CAEA,cAAe,SAASC,SAAT,CAAkBC,GAAlB,CAAuD,oEAAJ,EAAI,CAA9BC,MAA8B,MAA9BA,MAA8B,CAAtBC,OAAsB,MAAtBA,OAAsB,CAAbC,IAAa,MAAbA,IAAa,CAClE,cAAwBR,QAAQ,EAAhC,wCAAOS,IAAP,eAAaC,OAAb,eACA,eAAsCV,QAAQ,EAA9C,yCAAOW,WAAP,eAAoBC,cAApB,eAEA,GAAMC,SAAQ,CAAGX,WAAW,EAA5B,CACA,GAAMY,SAAQ,CAAGX,WAAW,EAA5B,CACA,QAASY,QAAT,EAAmB,CACfC,KAAK,CAACX,GAAD,CAAM,CACPC,MAAM,CAAEA,MADD,CAEPC,OAAO,CAAEA,OAFF,CAGPC,IAAI,CAAEA,IAHC,CAAN,CAAL,CAKKS,IALL,CAKU,SAACC,QAAD,CAAc,CAChB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzBN,QAAQ,CAAC,QAAD,CAAW,CACfO,KAAK,CAAE,CACHC,WAAW,CAAEP,QAAQ,CAACQ,QADnB,CADQ,CAAX,CAAR,CAKH,CACD,GAAI,CAACJ,QAAQ,CAACK,EAAd,CAAkB,CACd,KAAML,SAAQ,CAACC,MAAf,CACH,CACD,MAAOD,SAAQ,CAACM,IAAT,EAAP,CACH,CAjBL,EAkBKP,IAlBL,CAkBU,SAACR,IAAD,CAAU,CACZC,OAAO,CAACD,IAAD,CAAP,CACH,CApBL,EAqBKgB,KArBL,CAqBW,SAACC,CAAD,CAAO,CACVd,cAAc,CAACc,CAAD,CAAd,CACH,CAvBL,EAwBH,CAED,QAASC,WAAT,CAAoBC,OAApB,CAA6B,CACzBZ,KAAK,CAACX,GAAD,CAAM,CACPC,MAAM,CAAE,MADD,CAEPC,OAAO,CAAEA,OAFF,CAGPC,IAAI,CAAEqB,IAAI,CAACC,SAAL,CAAeF,OAAf,CAHC,CAAN,CAAL,CAKKX,IALL,CAKU,SAACC,QAAD,CAAc,CAChB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzBN,QAAQ,CAAC,QAAD,CAAW,CACfO,KAAK,CAAE,CACHC,WAAW,CAAEP,QAAQ,CAACQ,QADnB,CADQ,CAAX,CAAR,CAKH,CAED,GAAI,CAACJ,QAAQ,CAACK,EAAd,CAAkB,CACd,KAAML,SAAQ,CAACC,MAAf,CACH,CAED,MAAOD,SAAQ,CAACM,IAAT,EAAP,CACH,CAnBL,EAoBKP,IApBL,CAoBU,SAACc,CAAD,CAAO,CACT,GAAMC,UAAS,CAAGC,MAAM,CAACC,MAAP,CAAcH,CAAd,EAAiB,CAAjB,CAAlB,CAEA,GAAMI,SAAQ,kBAAQ1B,IAAR,CAAd,CACAwB,MAAM,CAACC,MAAP,CAAcC,QAAd,EAAwB,CAAxB,EAA2BC,IAA3B,CAAgCJ,SAAhC,EAEAtB,OAAO,CAACyB,QAAD,CAAP,CAAmB;AACtB,CA3BL,EA4BKV,KA5BL,CA4BW,SAACC,CAAD,CAAO,CACVW,OAAO,CAACC,GAAR,CAAYZ,CAAZ,EACAd,cAAc,CAACc,CAAD,CAAd,CACH,CA/BL,EAgCH,CAED,MAAO,CAAEX,OAAO,CAAPA,OAAF,CAAWY,UAAU,CAAVA,UAAX,CAAuBlB,IAAI,CAAJA,IAAvB,CAA6BE,WAAW,CAAXA,WAA7B,CAAP,CACH"},"metadata":{},"sourceType":"module"}